// Copyright (C) 2025 Enedis Smarties team <dt-dsi-nexus-lab-smarties@enedis.fr>
//
// SPDX-FileContributor: Jehan BOUSCH
// SPDX-FileContributor: Mathieu SABARTHES
//
// SPDX-License-Identifier: Apache-2.0

package enedis.lab.protocol.tic.frame.historic;

import enedis.lab.protocol.tic.TICMode;
import enedis.lab.protocol.tic.frame.TICFrame;

/**
 * TIC frame historic
 */
public class TICFrameHistoric extends TICFrame
{
	/// ////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
	///
	/// CONSTANTS
	///
	/// ////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

	/** Separator */
	public static final byte SEPARATOR = 0x20; // SP

	/// ////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
	///
	/// TYPES
	///
	/// ////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

	/// ////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
	///
	/// STATIC METHODS
	///
	/// ////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

	/// ////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
	///
	/// ATTRIBUTES
	///
	/// ////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

	/// ////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
	///
	/// CONSTRUCTORS
	///
	/// ////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

	/**
	 * Default constructor
	 */
	public TICFrameHistoric()
	{
		super();
	}

	/// ////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
	///
	/// INTERFACE
	/// TICFrame
	///
	/// ////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

	@Override
	public TICFrameHistoricDataSet addDataSet(String label, String data)
	{
		return this.addDataSet(this.DataSetList.size(), label, data);
	}

	@Override
	public TICFrameHistoricDataSet addDataSet(int index, String label, String data)
	{
		TICFrameHistoricDataSet dataSet = (TICFrameHistoricDataSet) this.getDataSet(label);

		if (dataSet == null)
		{
			dataSet = new TICFrameHistoricDataSet();
			dataSet.setLabel(label);
			dataSet.setData(data);
			dataSet.getConsistentChecksum();

			if ((index >= 0) && (index < this.DataSetList.size()))
			{
				this.DataSetList.add(index, dataSet);
			}

			else
			{
				this.DataSetList.add(dataSet);
			}
		}

		else
		{
			dataSet.setData(data);
			dataSet.getConsistentChecksum();

			this.DataSetList.remove(dataSet);

			if (index >= this.DataSetList.size())
			{
				this.DataSetList.add(dataSet);
			}

			else
			{
				this.DataSetList.add(index, dataSet);
			}
		}

		return dataSet;
	}

	@Override
	public TICMode getMode()
	{
		return TICMode.HISTORIC;
	}

	/// ////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
	///
	/// PUBLIC METHODS
	///
	/// ////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

	/// ////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
	///
	/// PROTECTED METHODS
	///
	/// ////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

	/// ////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
	///
	/// PRIVATE METHODS
	///
	/// ////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

}
